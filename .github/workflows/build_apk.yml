name: 📦 Build APK with Buildozer

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: 🧾 Checkout code
        uses: actions/checkout@v4

      - name: 🧰 Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: 🛠️ Install system dependencies
  run: |
    sudo apt-get update
    sudo apt-get install -y \
      build-essential \
      ccache \
      git \
      zip \
      unzip \
      openjdk-11-jdk \
      python3-pip \
      libffi-dev \
      libssl-dev \
      libjpeg-dev \
      zlib1g-dev \
      libncurses5-dev \
      libtinfo5 \
      libsqlite3-dev \
      libgstreamer1.0-dev \
      libgstreamer-plugins-base1.0-dev \
      libmtdev-dev \
      libgl1-mesa-dev \
      libgles2-mesa-dev \
      libudev-dev \
      libdrm-dev \
      libasound2-dev \
      libpulse-dev \
      libx11-dev

    python3 -m pip install --upgrade pip
    pip install --user buildozer cython


      - name: 📦 Build APK
        run: |
          buildozer android debug

      - name: 📤 Upload APK artifact
        uses: actions/upload-artifact@v4
        with:
          name: RoyalWinAI-APK
          path: bin/*.apk
